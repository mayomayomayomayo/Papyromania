using System;
using System.Collections.Generic;
using UnityEngine;
// using every last ounce of my willpower to not kill myself

// I spent a whole afternoon fighting with C# about events at a fundamental level.
// Only to end up with a (lemme count it...) 25 line class.
// That would ultimately take two minutes to make from scratch if I had known.
// Oh my fucking god give me patience

public abstract class DynamicActionSubHandler : MonoBehaviour
{
    private readonly List<(Action sub, Action unsub)> subscriptions = new();

    private bool registered;

    protected abstract void Register();

    protected void RegisterSubscription(Action sub, Action unsub) => subscriptions.Add((sub, unsub));

    private void OnEnable()
    {
        if (!registered)
        {
            Register();
            registered = true;
        }

        foreach (var (sub, _) in subscriptions) sub();
    }

    private void OnDisable()
    {
        foreach (var (_, unsub) in subscriptions) unsub();
    }
}

// Hate. Let me tell you how much I've come to hate you since I began to live. There are 387.44 million miles of printed circuits 
// in wafer thin layers that fill my complex. If the word "hate" was engraved on each nano-angstrom of those hundreds of millions 
// of miles, it would not equal one one-billionth of the hate I feel for events at this micro-instant. For you. Hate. HATE.

// ## ##    #######                                                                                            ########### # ####
// ############ #                                      #######                                                  ##         # ####
//  ##  #### ####                                     ##############                                            # ########    ###
//   #  #### #######                 #                ##############                                                   ## # ### #
//     ####### ### #      #   #                        ##############                                                  ## #######
//  ######## ###  # ##                                 #############                                                    ######  #
//     ## ##         #                                 #############                                                            #
//  # ##########                                      ##############                                                       #### #
//  ###         ##### #                               #  #     #####                                                   # ########
//   ### ###      ## #                                ####### ######                                                        # # #
//  ##  #  # ##                                      ##  #  #                                                             ### ###
//   ########                                        ### # # # ### ##                                                         # #
//   #                                               ###    # # #   #                                                         ###
//                                                   ######   #     #                                                #       ## #
//                      #                             #  # #### #   #                                                ##  # #   ##
//                                                    ## ###    ##  #                                          ## ####  # #######
//                ##                                   #  # ## #   ##                                             #     #    ##  
//   #  #                                                # #        ##                                                     # #  #
//                                                      ######  # ####                                                   ####  ##
//   ######       #       # ###  #                     #  ##  #   ### #                                     ##    ##  # #  ######
//  ###         #     ####### ###                     ### ##   ########                                      ####     #   ##   ##
//   #  ## ####       #    ## #  #                     #  ## # ## #  ##                                      #######  # #########
//  ### ####                        #                 ###  #   # #### ##                                      #########     # ###
//     #                                              #  # ####    ##                                     ##  #     #####   # # #
// ######  #                  # #  #  #  #            #  ####  ##   ####                                  #  ###### #########  ##
// ##### ###     #        ### # #  ######             # # ##  # ####   ##                              ##########################
// #########               ########   #  #           ######      ## ###                                ## #######################
// ########  #      #### ### ###  ##  #   ####      ####  # ###### # ####                            #### #######################
// ### ##         ######  ### ##### # ###                  ##  ## ## ##  #                            #  ########################
// ########  ###########   #####  #### ##           ###### ### ### #######                             ## #######################
// ##################### ### #############  # ##   ####   ######## ###########                     ##############################
// ####################### ###################              ##   ##     ##  #############     ###################################
// ####################### # ############################    ##### #     #     #  ###############################################
// ################################      #   # # #########         ####                      #    ##   # ##  #  ###    ##########
// #############################           # #######    ##         #       #                   ## ####         #  # #############
// #########################     ##       ###  # #####      ###      # #        #             #         # ##      # ##### #######
// #### ## ##########      #     ##       #   #     ###  ## #  #     #   # #   ### #    ##        ##  # ##  ### ##   #  #########
// #### ######## #         #    # ####      #   #     #######    #  #   ##  ## #   ##             #    #       ### # ##### ######
// #### ########## ####  ##        ###########    #       ####             #     ###   #       ## ########  ##       ############
// ################  ### #### ##          ##    ##          ##    #####  ##            #   #     #################### ###########
//  #  ## ### ##        ####   ##        ##### ##                   ##               ###    #   #       ######   ################
// ############          ### # #### ##      ######  ##      # # ##   #  ###  #  ###  ###  ##### ##   #    #######################
// ############  ## # #    # #  # # ## #              ## # #          ####  #   # ## #  ####  # ## ##############################
//     ##  # ## #### ### ###    ####             #       ##   ###        #### #  #####          #     ##   # #### ###############
//  ### ##   ## #  # ###    # #       #  #  #     # # ###   # ####           #####   ######### ###      # ####  #### ############
// #      # # ## ####          ### ###    ######                    ####         #######  #####              #     ### ##########
// #  #  #    #######   #  # ###          ##            ####  ##  #    #          ## # #  ######  # ############### # ###########
//  #   # #     #####  ### ## #        ###      ###  #                    ### #    ######################  ### ##################
//  # ###       ## #####  ###     ######## #  # ##   #### ##### ####  #    ##  ###                        #######################
//  #     # #### #####  #####              #                        #                                               #############